# 旅游笔记服务 API 文档

## 基本信息

- **基础URL**: `/api`
- **响应格式**: JSON
- **认证方式**: JWT (Bearer Token)
- **版本**: 1.0.0

## 通用响应格式

### 成功响应
```json
{
  "status": "success",
  "message": "操作成功",
  "data": { 
    // 返回的数据
  }
}
```

### 分页响应
```json
{
  "status": "success",
  "message": "获取数据成功",
  "data": {
    "items": [ /* 数据项列表 */ ],
    "pagination": {
      "total": 100,
      "page": 1,
      "limit": 10,
      "pages": 10
    }
  }
}
```

### 错误响应
```json
{
  "status": "error",
  "message": "错误信息",
  "error": {
    "code": "ERROR_CODE",
    "details": {} // 可选的详细错误信息
  }
}
```

## 公共接口

### 系统状态

#### 获取首页信息
- **URL**: `/`
- **方法**: `GET`
- **描述**: 获取API服务基本信息
- **响应示例**:
```json
{
  "status": "success",
  "message": "旅游笔记服务已成功启动",
  "version": "1.0.0",
  "endpoints": {
    "users": "/api/users",
    "travelLogs": "/api/travel-logs",
    "audits": "/api/audits"
  }
}
```

#### 健康检查
- **URL**: `/health`
- **方法**: `GET`
- **描述**: 检查API服务是否正常运行
- **响应示例**:
```json
{
  "status": "success",
  "message": "服务正常运行",
  "timestamp": "2023-05-26T08:30:22.123Z"
}
```

## 用户 APIs

### 用户注册
- **URL**: `/users/register`
- **方法**: `POST`
- **认证**: 不需要
- **描述**: 注册新用户账号
- **请求格式**: `multipart/form-data`
- **请求参数**:
  - `username`: 用户名 (必须，3-20个字符)
  - `password`: 密码 (必须，至少6个字符)
  - `nickname`: 昵称 (可选)
  - `avatar`: 用户头像文件 (可选，图片文件)
- **响应示例**:
```json
{
  "status": "success",
  "message": "注册成功",
  "data": {
    "user": {
      "user_id": 1,
      "username": "user123",
      "nickname": "旅行者",
      "avatar": "/uploads/avatars/user123.webp",
      "role": "user"
    },
    "token": "jwt-token-string"
  }
}
```

### 用户登录
- **URL**: `/users/login`
- **方法**: `POST`
- **认证**: 不需要
- **描述**: 用户登录并获取JWT令牌
- **请求格式**: `application/json`
- **请求参数**:
  - `username`: 用户名 (必须)
  - `password`: 密码 (必须)
- **响应示例**:
```json
{
  "status": "success",
  "message": "登录成功",
  "data": {
    "user": {
      "user_id": 1,
      "username": "user123",
      "nickname": "旅行者",
      "avatar": "/uploads/avatars/user123.webp",
      "role": "user"
    },
    "token": "jwt-token-string"
  }
}
```

### 获取当前用户信息
- **URL**: `/users/me`
- **方法**: `GET`
- **认证**: 需要
- **描述**: 获取当前登录用户的信息
- **响应示例**:
```json
{
  "status": "success",
  "data": {
    "user": {
      "user_id": 1,
      "username": "user123",
      "nickname": "旅行者",
      "avatar": "/uploads/avatars/user123.webp",
      "role": "user",
      "created_at": "2023-05-26T08:30:22.123Z"
    }
  }
}
```

### 更新用户信息
- **URL**: `/users/me`
- **方法**: `PUT`
- **认证**: 需要
- **描述**: 更新当前用户的个人信息
- **请求格式**: `application/json`
- **请求参数**:
  - `nickname`: 新昵称 (可选)
  - `password`: 新密码 (可选)
- **响应示例**:
```json
{
  "status": "success",
  "message": "用户信息更新成功",
  "data": {
    "user": {
      "user_id": 1,
      "username": "user123",
      "nickname": "新昵称",
      "avatar": "/uploads/avatars/user123.webp",
      "role": "user"
    }
  }
}
```

### 获取所有用户 (管理员)
- **URL**: `/users`
- **方法**: `GET`
- **认证**: 需要
- **权限**: 管理员
- **描述**: 获取所有用户列表(分页)
- **查询参数**:
  - `page`: 页码 (默认 1)
  - `limit`: 每页数量 (默认 10)
- **响应示例**:
```json
{
  "status": "success",
  "data": {
    "users": [
      {
        "user_id": 1,
        "username": "user123",
        "nickname": "旅行者",
        "avatar": "/uploads/avatars/user123.webp",
        "role": "user",
        "status": "active",
        "created_at": "2023-05-26T08:30:22.123Z"
      },
      // 更多用户...
    ],
    "pagination": {
      "total": 50,
      "page": 1,
      "limit": 10,
      "pages": 5
    }
  }
}
```

## 游记 APIs

### 获取游记列表
- **URL**: `/travel-logs`
- **方法**: `GET`
- **认证**: 不需要
- **描述**: 获取公开的游记列表(分页)
- **查询参数**:
  - `page`: 页码 (默认 1)
  - `limit`: 每页数量 (默认 10)
  - `search`: 搜索关键词 (可选)
- **响应示例**:
```json
{
  "status": "success",
  "message": "获取游记列表成功",
  "data": {
    "items": [
      {
        "log_id": 1,
        "title": "北京之旅",
        "content": "游记内容...",
        "image_urls": [
          "/uploads/images/beijing_medium.webp"
        ],
        "video_url": "/uploads/videos/beijing_processed.mp4",
        "created_at": "2023-05-26T08:30:22.123Z",
        "comment_count": 10,
        "like_count": 25,
        "favorite_count": 5,
        "author": {
          "user_id": 1,
          "nickname": "旅行者",
          "avatar": "/uploads/avatars/user123.webp"
        },
        "tags": [
          { "tag_id": 1, "tag_name": "北京" },
          { "tag_id": 2, "tag_name": "文化" }
        ]
      },
      // 更多游记...
    ],
    "pagination": {
      "total": 100,
      "page": 1,
      "limit": 10,
      "pages": 10
    }
  }
}
```

### 获取游记详情
- **URL**: `/travel-logs/:id`
- **方法**: `GET`
- **认证**: 不需要
- **描述**: 获取单个游记的详细信息
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "获取游记详情成功",
  "data": {
    "travel_log": {
      "log_id": 1,
      "title": "北京之旅",
      "content": "游记详细内容...",
      "image_urls": [
        "/uploads/images/beijing_medium.webp"
      ],
      "video_url": "/uploads/videos/beijing_processed.mp4",
      "thumbnail_url": "/uploads/thumbnails/beijing.jpg",
      "created_at": "2023-05-26T08:30:22.123Z",
      "updated_at": "2023-05-26T10:22:45.678Z",
      "comment_count": 10,
      "like_count": 25,
      "favorite_count": 5,
      "author": {
        "user_id": 1,
        "nickname": "旅行者",
        "avatar": "/uploads/avatars/user123.webp"
      },
      "tags": [
        { "tag_id": 1, "tag_name": "北京" },
        { "tag_id": 2, "tag_name": "文化" }
      ],
      "comments": [
        {
          "comment_id": 1,
          "content": "很棒的游记!",
          "created_at": "2023-05-26T09:12:34.567Z",
          "author": {
            "user_id": 2,
            "nickname": "评论者",
            "avatar": "/uploads/avatars/user456.webp"
          }
        },
        // 更多评论...
      ]
    }
  }
}
```

### 获取当前用户的游记列表
- **URL**: `/travel-logs/me`
- **方法**: `GET`
- **认证**: 需要
- **描述**: 获取当前用户创建的游记列表
- **查询参数**:
  - `page`: 页码 (默认 1)
  - `limit`: 每页数量 (默认 10)
  - `status`: 游记状态 (可选，'pending'/'approved'/'rejected')
- **响应示例**:
```json
{
  "status": "success",
  "message": "获取个人游记列表成功",
  "data": {
    "items": [
      {
        "log_id": 1,
        "title": "北京之旅",
        "content": "游记内容...",
        "image_urls": [
          "/uploads/images/beijing_medium.webp"
        ],
        "video_url": "/uploads/videos/beijing_processed.mp4",
        "status": "approved",
        "created_at": "2023-05-26T08:30:22.123Z",
        "updated_at": "2023-05-26T10:22:45.678Z",
        "comment_count": 10,
        "like_count": 25,
        "favorite_count": 5,
        "tags": [
          { "tag_id": 1, "tag_name": "北京" },
          { "tag_id": 2, "tag_name": "文化" }
        ]
      },
      // 更多游记...
    ],
    "pagination": {
      "total": 20,
      "page": 1,
      "limit": 10,
      "pages": 2
    }
  }
}
```

### 创建游记
- **URL**: `/travel-logs`
- **方法**: `POST`
- **认证**: 需要
- **描述**: 创建新的游记
- **请求格式**: `application/json`
- **请求参数**:
  - `title`: 游记标题 (必须)
  - `content`: 游记内容 (必须)
  - `image_urls`: 图片URL数组 (可选)
  - `video_url`: 视频URL (可选)
  - `tags`: 标签数组 (可选)
- **响应示例**:
```json
{
  "status": "success",
  "message": "游记创建成功，等待审核",
  "data": {
    "travel_log": {
      "log_id": 1,
      "title": "北京之旅",
      "status": "pending",
      "created_at": "2023-05-26T08:30:22.123Z"
    }
  }
}
```

### 更新游记
- **URL**: `/travel-logs/:id`
- **方法**: `PUT`
- **认证**: 需要
- **描述**: 更新现有游记
- **路径参数**:
  - `id`: 游记ID
- **请求格式**: `application/json`
- **请求参数**:
  - `title`: 游记标题 (可选)
  - `content`: 游记内容 (可选)
  - `image_urls`: 图片URL数组 (可选)
  - `video_url`: 视频URL (可选)
  - `tags`: 标签数组 (可选)
- **响应示例**:
```json
{
  "status": "success",
  "message": "游记更新成功，等待审核",
  "data": {
    "travel_log": {
      "log_id": 1,
      "title": "北京之旅(更新)",
      "status": "pending",
      "updated_at": "2023-05-26T10:22:45.678Z"
    }
  }
}
```

### 删除游记
- **URL**: `/travel-logs/:id`
- **方法**: `DELETE`
- **认证**: 需要
- **描述**: 删除游记
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "游记删除成功"
}
```





Read file: src/middleware/auth.js

Read file: src/routes/travelLogRoutes.js

Read file: src/routes/userRoutes.js

Ran tool

Ran tool

Read file: src/controllers/userController.js
# 文件上传下载接口文档

## 接口概述

本文档详细描述了系统中与文件（图片、视频、头像）上传和下载相关的API接口，包括权限要求、请求参数和响应格式。

## 身份认证

除特别说明外，所有文件上传操作都需要身份认证。系统使用JWT令牌进行身份验证：

- 在请求头中添加 `Authorization: Bearer {token}`
- 令牌通过登录接口获取：`POST /api/users/login`
- 令牌过期时间：默认24小时

## 1. 图片上传

### 端点
```
POST /api/travel-logs/upload-images
```

### 权限要求
- 需要登录用户（任何角色）
- 需要有效的JWT令牌

### 请求
- **Content-Type**: `multipart/form-data`
- **字段**: `images` (可上传多张图片，最多10张)
- **支持格式**: JPEG, PNG, GIF, WebP
- **大小限制**: 100MB (默认)
- **请求头**: `Authorization: Bearer {token}`

### 响应
```json
{
  "status": "success",
  "message": "图片上传并处理成功",
  "data": {
    "image_urls": [
      "images/f7e8d9c1-a2b3-4c5d-e6f7-g8h9i0j1k2l3.webp",
      "images/a1b2c3d4-e5f6-7g8h-9i0j-k1l2m3n4o5p6.webp"
    ]
  }
}
```

### 错误响应
```json
{
  "status": "error",
  "message": "未提供图片文件",
  "code": "BAD_REQUEST"
}
```

```json
{
  "status": "error",
  "message": "不支持的图片类型。只允许JPEG, PNG, GIF, WebP格式",
  "code": "UNSUPPORTED_FORMAT"
}
```

```json
{
  "status": "error",
  "message": "文件大小超出限制",
  "code": "LIMIT_FILE_SIZE"
}
```

## 2. 视频上传

### 端点
```
POST /api/travel-logs/upload-video
```

### 权限要求
- 需要登录用户（任何角色）
- 需要有效的JWT令牌

### 请求
- **Content-Type**: `multipart/form-data`
- **字段**: `video` (单个视频文件)
- **支持格式**: MP4, MPEG, MOV, AVI
- **大小限制**: 100MB (默认)
- **请求头**: `Authorization: Bearer {token}`

### 响应
```json
{
  "status": "success",
  "message": "视频上传成功",
  "data": {
    "video_url": "videos/f7e8d9c1-a2b3-4c5d-e6f7_8fa43c19.mp4",
    "status": "processing",
    "process_id": "550e8400-e29b-41d4-a716-446655440000",
    "message": "视频已上传，正在后台处理中，您可以继续操作。"
  }
}
```

### 错误响应
与图片上传类似，但针对视频格式。

## 3. 头像上传

### 端点
```
POST /api/users/me/avatar
```

### 权限要求
- 需要登录用户（任何角色）
- 只能更新自己的头像
- 需要有效的JWT令牌

### 请求
- **Content-Type**: `multipart/form-data`
- **字段**: `avatar` (单个图片文件)
- **支持格式**: JPEG, PNG, GIF, WebP
- **大小限制**: 2MB
- **请求头**: `Authorization: Bearer {token}`

### 响应
```json
{
  "status": "success",
  "message": "头像更新成功",
  "data": {
    "user": {
      "user_id": 123,
      "username": "johndoe",
      "nickname": "John",
      "avatar": "avatars/f7e8d9c1-a2b3-4c5d-e6f7-g8h9i0j1k2l3.webp",
      "role": "user"
    }
  }
}
```

### 错误响应
与图片上传类似，但特定于头像。

## 4. 视频处理进度查询

### 端点
```
GET /api/travel-logs/video-progress/:process_id
```

### 权限要求
- 公开接口（不需要身份认证）
- 任何人都可以通过处理ID查询进度

### 请求
- **参数**: `process_id` - 视频上传时返回的处理ID

### 响应
```json
{
  "status": "success",
  "message": "获取视频处理进度成功",
  "data": {
    "process_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "processing_video",
    "progress": 65,
    "message": "视频处理中 65%...",
    "created_at": "2023-06-15T08:30:25.123Z",
    "filename": "myvideo_8fa43c19"
  }
}
```

### 可能的处理状态
- `preparing`: 准备处理（0%）
- `processing_video`: 处理中（10%-99%）
- `completed`: 处理完成（100%）
- `error`: 处理出错

## 5. 文件下载

### 端点
```
GET /api/download/:type/:filename
```

### 权限要求
- 公开接口（不需要身份认证）
- 任何人都可以通过URL下载公开文件

### 请求
- **参数**:
  - `type`: 文件类型，可选值: `images`, `videos`, `avatars`
  - `filename`: 文件名，不包含路径，例如 `f7e8d9c1-a2b3-4c5d-e6f7-g8h9i0j1k2l3.webp`

### 响应
- **成功**: 返回文件的二进制流，触发浏览器下载
- **失败**: 返回JSON格式错误信息

```json
{
  "status": "error",
  "message": "文件不存在"
}
```

## 安全性和限制

1. **文件大小限制**:
   - 图片和视频: 100MB
   - 头像: 2MB

2. **格式限制**:
   - 图片: JPEG, PNG, GIF, WebP
   - 视频: MP4, MPEG, MOV, AVI

3. **权限控制**:
   - 上传操作需要身份验证
   - 头像只能由用户自己更新
   - 下载操作为公开访问

4. **防注入措施**:
   - 文件名经过清理和验证
   - 路径参数经过验证，防止路径遍历攻击

5. **访问控制**:
   - 系统保存图片和视频到安全目录
   - 通过特定下载接口访问文件，而不是直接暴露文件系统路径

## 处理规格

1. **图片处理**:
   - 处理为中等质量: 800像素宽度，70%质量
   - 转换为WebP格式以提高压缩率
   - 保持原始宽高比

2. **视频处理**:
   - 处理为标准质量: 720p分辨率
   - 音频: AAC格式，128kbps
   - 视频: H.264编码，保持原始宽高比

3. **头像处理**:
   - 处理为标准尺寸: 200x200像素
   - 转换为WebP格式，80%质量
   - 使用中心裁剪以保持面部特征

## 使用示例

### 上传并显示图片
```javascript
// 上传图片
const formData = new FormData();
formData.append('images', fileInput.files[0]);

fetch('/api/travel-logs/upload-images', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
})
.then(response => response.json())
.then(data => {
  if (data.status === 'success') {
    // 显示图片 - 添加/uploads前缀
    const imageUrl = `/uploads/${data.data.image_urls[0]}`;
    document.getElementById('preview').src = imageUrl;
    
    // 下载图片链接
    const downloadUrl = `/api/download/${data.data.image_urls[0]}`;
    document.getElementById('download-link').href = downloadUrl;
  } else {
    console.error('上传失败:', data.message);
  }
})
.catch(error => {
  console.error('请求错误:', error);
});
```

### 上传视频并监控进度
```javascript
// 上传视频
const formData = new FormData();
formData.append('video', videoInput.files[0]);

fetch('/api/travel-logs/upload-video', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
})
.then(response => response.json())
.then(data => {
  if (data.status === 'success') {
    // 保存视频URL和处理ID
    const videoUrl = `/uploads/${data.data.video_url}`;
    const processId = data.data.process_id;
    
    // 定时检查处理进度
    const progressInterval = setInterval(() => {
      fetch(`/api/travel-logs/video-progress/${processId}`)
        .then(res => res.json())
        .then(progressData => {
          document.getElementById('progress').textContent = 
            `${progressData.data.progress}% - ${progressData.data.message}`;
            
          if (progressData.data.status === 'completed') {
            clearInterval(progressInterval);
            document.getElementById('video-player').src = videoUrl;
            document.getElementById('video-player').style.display = 'block';
          }
        });
    }, 3000);
  }
})
.catch(error => {
  console.error('请求错误:', error);
});
```





## 错误处理

所有接口在发生错误时将返回统一格式的错误响应:

```json
{
  "status": "error",
  "message": "错误描述信息",
  "code": "错误代码(可选)"
}
```

常见错误:
- `400` - 请求参数错误(如未提供文件、格式不支持等)
- `404` - 资源不存在
- `413` - 文件大小超过限制
- `500` - 服务器内部错误

## 使用说明

1. 文件上传后返回的URL不包含域名和`/uploads`前缀，只返回相对路径
2. 在前端显示图片或视频时，需要自行拼接完整URL
3. 下载文件时，使用返回的URL路径中的类型和文件名调用下载接口
4. 图片处理只保留中等质量的图片(800px宽，70%质量)
5. 视频处理只保留标准质量的视频(720p)



### 创建评论

- **URL**: `/api/comments`
- **方法**: `POST`
- **请求格式**: `application/json`
- **描述**: 创建游记评论
- **认证**: 需要

**请求参数**:

| 参数名    | 类型   | 必填 | 描述                              |
|-----------|--------|------|----------------------------------|
| log_id    | number | 是   | 游记ID                           |
| content   | string | 是   | 评论内容，1-500个字符             |

**响应示例**:

```json
{
  "status": "success",
  "message": "评论发布成功",
  "data": {
    "comment": {
      "comment_id": 1,
      "content": "非常精彩的游记！",
      "created_at": "2023-07-02T09:00:00.000Z",
      "author": {
        "user_id": 2,
        "nickname": "评论者",
        "avatar": "commenter.jpg"
      }
    }
  }
}
```

### 删除评论

- **URL**: `/api/comments/:id`
- **方法**: `DELETE`
- **描述**: 删除自己的评论(或管理员删除任意评论)
- **认证**: 需要

**URL参数**:

| 参数名 | 类型   | 描述   |
|--------|--------|--------|
| id     | number | 评论ID |

**响应示例**:

```json
{
  "status": "success",
  "message": "评论删除成功"
}
```

### 获取游记评论列表

- **URL**: `/api/travel-logs/:id/comments`
- **方法**: `GET`
- **描述**: 获取某篇游记的评论列表
- **认证**: 不需要

**URL参数**:

| 参数名 | 类型   | 描述   |
|--------|--------|--------|
| id     | number | 游记ID |

**查询参数**:

| 参数名 | 类型   | 必填 | 描述                 |
|--------|--------|------|---------------------|
| page   | number | 否   | 页码，默认为1        |
| limit  | number | 否   | 每页记录数，默认为10 |

**响应示例**:

```json
{
  "status": "success",
  "message": "获取评论列表成功",
  "data": {
    "items": [
      {
        "comment_id": 1,
        "content": "非常精彩的游记！",
        "created_at": "2023-07-02T09:00:00.000Z",
        "author": {
          "user_id": 2,
          "nickname": "评论者",
          "avatar": "commenter.jpg"
        }
      },
      // 更多评论...
    ],
    "pagination": {
      "total": 15,
      "page": 1,
      "limit": 10,
      "pages": 2
    }
  }
}
```

### 点赞游记
- **URL**: `/travel-logs/:id/like`
- **方法**: `POST`
- **认证**: 需要
- **描述**: 对游记进行点赞
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "点赞成功",
  "data": {
    "like_count": 26
  }
}
```

### 取消点赞
- **URL**: `/travel-logs/:id/like`
- **方法**: `DELETE`
- **认证**: 需要
- **描述**: 取消对游记的点赞
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "取消点赞成功",
  "data": {
    "like_count": 25
  }
}
```

### 收藏游记
- **URL**: `/travel-logs/:id/favorite`
- **方法**: `POST`
- **认证**: 需要
- **描述**: 收藏游记
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "收藏成功",
  "data": {
    "favorite_count": 6
  }
}
```

### 取消收藏
- **URL**: `/travel-logs/:id/favorite`
- **方法**: `DELETE`
- **认证**: 需要
- **描述**: 取消收藏游记
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "取消收藏成功",
  "data": {
    "favorite_count": 5
  }
}
```

## 审核 APIs (管理员/审核员)

### 获取待审核游记列表
- **URL**: `/audits/travel-logs`
- **方法**: `GET`
- **认证**: 需要
- **权限**: 管理员/审核员
- **描述**: 获取需要审核的游记列表
- **查询参数**:
  - `page`: 页码 (默认 1)
  - `limit`: 每页数量 (默认 10)
  - `status`: 游记状态 (可选，'pending'/'approved'/'rejected')
- **响应示例**:
```json
{
  "status": "success",
  "message": "获取待审核游记列表成功",
  "data": {
    "items": [
      {
        "log_id": 1,
        "title": "北京之旅",
        "content": "游记内容...",
        "image_urls": [
          "/uploads/images/beijing_medium.webp"
        ],
        "video_url": "/uploads/videos/beijing_processed.mp4",
        "status": "pending",
        "created_at": "2023-05-26T08:30:22.123Z",
        "updated_at": "2023-05-26T08:30:22.123Z",
        "author": {
          "user_id": 1,
          "nickname": "旅行者",
          "avatar": "/uploads/avatars/user123.webp"
        }
      },
      // 更多游记...
    ],
    "pagination": {
      "total": 15,
      "page": 1,
      "limit": 10,
      "pages": 2
    }
  }
}
```

### 获取待审核游记详情
- **URL**: `/audits/travel-logs/:id`
- **方法**: `GET`
- **认证**: 需要
- **权限**: 管理员/审核员
- **描述**: 获取待审核游记的详细信息
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "获取待审核游记详情成功",
  "data": {
    "travel_log": {
      "log_id": 1,
      "title": "北京之旅",
      "content": "游记详细内容...",
      "image_urls": [
        "/uploads/images/beijing_medium.webp"
      ],
      "video_url": "/uploads/videos/beijing_processed.mp4",
      "thumbnail_url": "/uploads/thumbnails/beijing.jpg",
      "status": "pending",
      "created_at": "2023-05-26T08:30:22.123Z",
      "updated_at": "2023-05-26T08:30:22.123Z",
      "author": {
        "user_id": 1,
        "nickname": "旅行者",
        "avatar": "/uploads/avatars/user123.webp"
      },
      "tags": [
        { "tag_id": 1, "tag_name": "北京" },
        { "tag_id": 2, "tag_name": "文化" }
      ]
    }
  }
}
```

### 审核游记
- **URL**: `/audits/travel-logs/:id`
- **方法**: `POST`
- **认证**: 需要
- **权限**: 管理员/审核员
- **描述**: 审核游记(通过或拒绝)
- **路径参数**:
  - `id`: 游记ID
- **请求格式**: `application/json`
- **请求参数**:
  - `audit_status`: 审核状态 (必须，'approved'/'rejected')
  - `reason`: 拒绝原因 (当audit_status为'rejected'时必须)
- **响应示例**:
```json
{
  "status": "success",
  "message": "审核完成",
  "data": {
    "log_id": 1,
    "title": "北京之旅",
    "status": "approved",
    "audit_time": "2023-05-26T10:30:22.123Z"
  }
}
```

### 删除游记 (管理员)
- **URL**: `/audits/travel-logs/:id`
- **方法**: `DELETE`
- **认证**: 需要
- **权限**: 管理员
- **描述**: 管理员删除游记
- **路径参数**:
  - `id`: 游记ID
- **响应示例**:
```json
{
  "status": "success",
  "message": "游记已删除"
}
```

## 错误代码

| 代码 | 描述 |
|------|------|
| 400 | 请求参数错误 |
| 401 | 未认证 |
| 403 | 权限不足 |
| 404 | 资源不存在 |
| 413 | 上传文件太大 |
| 422 | 数据验证失败 |
| 500 | 服务器内部错误 | 